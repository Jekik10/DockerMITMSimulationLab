# Utilizza l'immagine ufficiale di Alpine
FROM ubuntu:latest

# Installa il pacchetti necessari
RUN apt-get update && \
    apt-get install -y \
    tcpdump \
    jq \
    suricata && \
    apt-get clean && \
    rm -rf /var/lib/apt/lists/*

# Copia lo script di configurazione dell ids nel container
COPY idsSetup.sh /bin

# Copia le regole di suricata
COPY suricata.rules /var/lib/suricata/rules/suricata.rules

# Rende eseguibile lo script
RUN chmod 755 /bin/idsSetup.sh

# Esegui e poi rimuovi lo script all'avvio del container
# CMD ["/bin/sh", "-c", "/bin/idsSetup.sh && rm /bin/idsSetup.sh && sleep infinity"]
CMD ["/bin/sh", "-c", "/bin/idsSetup.sh && sleep infinity"]
