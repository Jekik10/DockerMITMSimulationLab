# Utilizza l'immagine ufficiale di Debian stable slim
FROM debian:stable-slim
# FROM debian:stable

# Aggiorna i pacchetti e installa solo i necessari
RUN apt-get update && \
    apt-get install -y \
    iptables \
    net-tools \
    iproute2 \
    vim \
    tcpdump && \
    apt-get clean && \
    rm -rf /var/lib/apt/lists/*

# Copia lo script di configurazione del router nel container
COPY script/routerSetup.sh /bin

# Rende eseguibile lo script
RUN chmod 755 /bin/routerSetup.sh

# Esegui lo script all'avvio del container

CMD ["/bin/sh", "-c", "/bin/routerSetup.sh && rm /bin/routerSetup.sh && sleep infinity"]

# Eseguo routerSetup.sh durante la fase di build perch√® Docker utilizza un 
# ambiente isolato che non influisce sulle impostazioni di rete del sistema 
# host o dei container runtime